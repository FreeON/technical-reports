<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="http://www.freeon.org/technical-reports/stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="http://www.freeon.org/technical-reports/stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="http://www.freeon.org/technical-reports/stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Technical Report 1</title>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-18986301-3', 'auto');
      ga('require', 'linkid', 'linkid.js');
      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script>

    <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });
    </script>

  </head>

  <body>
    <header>
      <div class="inner">
        <h1><a href="/technical-reports/" style="color:#fff">Technical Reports</a></h1>
        <h2>of the FreeON project</h2>
        <!--
        <a href="https://github.com/FreeON/technical-reports" class="button">
          <small>View project on</small> GitHub
        </a>
        -->
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

<h1 id="manifesto">Manifesto</h1>

<p>A majority use of supercomputers involves the broad application of electronic
structure, as many of the most interesting and important problems in
chemistry, biology and materials science can only be answered with non-trivial
quantum theories.  In addition to scalable parallelism, new opportunities for
quantum simulation have developed over the last two decades;  based on the
locality principle of electronic matter, modern electronic structure codes
have been able to achieve dramatically reduced computational complexities,
e.g.  from <script type="math/tex">O(N^4) \rightarrow O(N)</script>.   Also, multi-decade efforts into
theory of the single-determinant Kohn-Sham representation are beginning to
convincingly yield high quality solutions for the non-local static
correlation, based on the long-range Fock exchange; these solutions are
apparent in  range-separated exchange <a href="#Scuseria2006">(Vydrov, Heyd, Krukau, &amp; Scuseria, 2006)</a>, and in
correlation on top of exchange methods*.  These long-ranged effects are key
to understanding the chemistry and physics of metal oxide systems, from the
biological reaction center to engineered perovskite systems in the materials
genome.   Achieving scalable parallelism, into the high throughput, strong
scaling regime, obtaining reduced <script type="math/tex">O(N^4) \rightarrow O(N)</script> complexities and
enabling transformative, high quality solutions to large problems involving
long range correlation effects is a grail-level enterprise.  We are writing to
propose some enabling principles &amp; technologies that might underpin such an
endeavor.  Since our first contributions*, the FreeON project has targeted
methods based primarily on the Fock exchange;  in the mid 90’s, we introduced
the first <script type="math/tex">O(N)</script> method for the two-electron integral (ERI) problem in
Hartree-Fock theory*.  Later, we were the first to develop Gamma-point
methods for the Fock exchange*,  the first to demonstrate an <script type="math/tex">O(N)</script> solve
of the Coupled-Perturbed Hartree-Fock (CPSCF) static response problem*,
through fourth order in the dielectric response*, and also the first to
achieve an <script type="math/tex">O(N)</script> solution for the Time-Dependent Hartree-Fock (TD-SCF/RPA)
matrix eigenvalue problem*.</p>

<p>The FreeON project* has been through many innovation cycles involving the
interdependence of five and more coupled solvers, demonstrating to us that
localized solvers optimization often inhibits the overall progress of the
computational ecosystem;  fast-solvers should interact holistically to give
the best overall performance in a science per watt (S/W) sense, the
corresponding lowest overall error,  provide a low barrier to entry, and
enable new and integrative science through evolution and extension.  Instead,
current solver ecosystems are an often a competing nest of impeding data
structures, perhaps having arisen with the bit-by-bit development and
optimization of individual capabilities.</p>

<p>Perhaps the most entrenched example of entangled and competing data structures
in modern electronic structure is the row-column framework embedded in
conventional sparse matrix formats*, including for example the BCSR &amp; DBCSR
formats introduced by us, together with a first described parallel sparse
matrix-matrix multiply*.   In addition to uncontrolled matrix approximations,
e.g. truncation*, row-column imposes one-dimensional lists-of-lists
structures on the computational kernels that employ them*.  This
one-dimensional restriction limits flexibility catastrophically in domain
decomposition*, preventing access of <script type="math/tex">O(N)</script> methods to the strong scaling
limit*.  Perhaps most significantly though, the ability to fully exploit
quantum locality through culling and occlusion is limited by heavyweight
overheads of the data structures.</p>

<p>The now universal Almlöf-Ahlrichs direct-SCF ERI screening protocol* finds
only the pair-wise <script type="math/tex">O(N^2)</script> most significant naive shell-pair interactions
(occlusion), avoiding the corresponding ERI cost (culling).   The granularity
imposed by the underlying symmetry and linear algebra was, at the time,
related to the extra x in the commonly given <script type="math/tex">O(N^{2.x})</script> of that period*.
We were the first to show that it is the <script type="math/tex">O(N^2)</script> complexity of occlusion in
the direct SCF that dominates the exchange component*, with the culled
integral cost coming in as expected at an <script type="math/tex">O(N)</script> cost*.  These skipout-list
methods* remain deeply entangled with the row-column structure of the
underlying sparse matrix formats,  the matrix truncation approximation itself,
and still inefficient (and often non-rigorous) methods of occlusion due to
symmetry operations, blocking &amp; etc.</p>

<p>After multiple revisions, we’ve achieved an innovative milestone with the
strong prototyping of all five SCF solvers within the recursive <script type="math/tex">n</script>-body
framework*.   This framework is characterized by recursive task parallelism
and empowered by common, high performance runtime stacks, e.g. charm++ and
OpenMP 4.0, with fine levels of granularity enabled by light weight and
efficient scheduling*.  The  generacity of the <script type="math/tex">n</script>-body framework has the
potential to simplify code bases, lower barriers to entry,  and otherwise
enable integrative scientific pursuits.  The <script type="math/tex">n</script>-body solver is based on
computation that is foremost a data science problem; we are interested in high
quality database solutions to the opportunities provided by locality
principles, including the optimization of data and task flow at the ecosystems
level, and enabling optimal queries that underly algorithms for occlusion and
culling, and for related technologies that enjoy kernel compression.  Good
spatial and temporal locality enhances fast kernel summation*, distributed
and persistence load balancing*,  caching*, propagation of auxiliary data
channels*, multi-time scale methods including tree-based averages*, parallel
in time methods* and the like.  <script type="math/tex">N</script>-body frameworks offer tree-based kernel
reductions related to data science problems encountering intense market
pressures, such as MapReduce* and spark*.   We are interested in the
alignment with commodity analytics because it represents a collaborative
groundswell that cannot be matched in managed environments, and because it
provides a flexible orientation for evolution within a rapidly changing
hardware environment, marked by much higher levels of concurrency at lower
levels of quality*.   Also,  it aligns powerful new methods for linear
algebra* with fast solvers for learning and classification*.  In electronic
structure, these solvers have demonstrated the ability to achieve <script type="math/tex">O(N)</script>
scaling for the computation of ill-conditioned matrix inverses*, where
truncation schemes fail impressively*, and also access to strong parallel
scaling in the <script type="math/tex">O(N)</script> regime, so far with access up to 500 cores/atom*.</p>

<p>This is a coincidence of remarkable new developments:  (1) in DFT, the ability
of single determinant representations to capture strong, many center
correlation effects based on the Fock exchange, (2) in high performance
algorithms able to access the high throughput, strong scaling regime and
<script type="math/tex">O(N)</script> complexities for more accurate but ill-conditioned models,
unobtainable with sparse matrix methods,  (3) in the emergence of accelerators
like the Intel KNL, heralding massively MIMD engines towards 100 Flop/Watt,
and (4) in the ability to re-frame solver collectives entirely within the
<script type="math/tex">n</script>-body model able to absorb massive heterogeneous parallelism.  Each of
these developments is disruptive.  The scientific and computational landscape
is changing so fast, it seems that only collaborative, peer driven development
can hope to keep pace.  We are writing to engage with the interested and like
minded in areas related to these developments, 1-4, as well as broadly in the
physical and data sciences.</p>

<p>It is important to establish veracity, performance and generacity metrics and
regressions for thin, high performance <script type="math/tex">n</script>-body libraries; we are leading at
github with the spammpack library* for fast multiplication of matrices with
decay*.  This sits on top of OpenMP and charm++ at the moment, and below
solvers for electronic structure, like the <script type="math/tex">n</script>-body Fock exchange*.   With
a collaborative approach, we think tremendous predictive power can fit into a
4U form factor over the next decade.  <script type="math/tex">N</script>-body solvers for the Fock exchange
hole grid will bring high quality, single determinant B13-like solutions to
problems dominated by the physics of long range correlation, including  doped,
derivativized and defect engineered metal oxide slabs (1000-5000 atom systems
in the dilute limit), perhaps economically interesting from the perspective of
materials genomics.</p>

<p>Developing the generacity of <script type="math/tex">n</script>-body recursion, perhaps with domain
specific languages*, will enable complex solver collectives that can absorb
large quantities of heterogeneous parallelism with minimal effort.  While we
don’t know the precise form this heterogeneous parallelism will take, we
believe that a data-science orientation provides the best opportunities for
exploiting it, for achieving a simplified code base, lower barriers to entry
and otherwise future proofing collaborative developments.</p>

<h1 id="bibliography">Bibliography</h1>

<ol class="bibliography"><li><span id="Scuseria2006">Vydrov, O. A., Heyd, J., Krukau, A. V., &amp; Scuseria, G. E. (2006). Importance of short-range versus long-range Hartree-Fock exchange
     for the performance of hybrid density functionals. <i>The Journal of Chemical Physics</i>, <i>125</i>(7).</span></li></ol>


        </section>

        <aside id="sidebar">
          <strong>Navigation</strong>
          <ul>
          
            <li><small><a href="/technical-reports/">Main</a></small></li>
          
          </ul>

          <p class="repo-owner">
          Spammpack is part of the <a href="/">FreeON Project</a>.
          </p>

          <p>This page was initially generated by
          <a href="https://pages.github.com">GitHub Pages</a>
          using the Architect theme by
          <a href="https://twitter.com/jasonlong">Jason Long</a>.
          Now it is hand groomed by the authors.</p>

          <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- responsive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4328959315579213"
     data-ad-slot="1424990250"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>


        </aside>
      </div>
    </div>
  </body>
</html>
